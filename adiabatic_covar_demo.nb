(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     83765,       2074]
NotebookOptionsPosition[     80987,       2021]
NotebookOutlinePosition[     81409,       2038]
CellTagsIndexPosition[     81366,       2035]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Import", "[", "\"\<https://qtechtheory.org/questlink.m\>\"", 
  "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateDownloadedQuESTEnv", "[", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Key", " ", "Variables"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numQs", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaT", " ", "=", " ", "0.15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"start", "=", 
   RowBox[{"Mod", "[", 
    RowBox[{"1.0", ",", "deltaT"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"layers", " ", "=", " ", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TargetEnergyLevel", " ", "=", " ", "1"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.932022288700487*^9, 3.9320223611923027`*^9}, {
  3.932635056677991*^9, 3.9326350568687553`*^9}, {3.933755427429782*^9, 
  3.933755427708177*^9}, {3.9338390613342533`*^9, 3.9338390907831984`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"ee69c2b9-9a5d-4159-b2a0-5b5df8704827"],

Cell[BoxData[
 TemplateBox[{
  "QuESTlink", "notice", 
   "\"Bug alert! Prior to this version (v0.19), SimplifyPaulis[] contained a \
bug whereby multiplying X and Z operators (targeting the same qubit) produced \
a Y operator with an incorrect sign. This bug occurred only when multiplying \
Pauli strings together, and did not affect other algebraic forms (like \
summing or exponentiation), though did affect the downstream function \
CalcPauliExpressionMatrix[]. Please check any previous calculations which \
passed products of Pauli-strings to SimplifyPaulis[] and \
CalcPauliExpressionMatrix[]. We sincerely apologise for any arising issues! \
Silence this warning using Quiet[].\"", 2, 94, 27, 18433722946922128711, 
   "Local", "QuEST`Private`QuESTlink"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.935659680393828*^9},
 CellLabel->
  "During evaluation of \
In[94]:=",ExpressionUUID->"99640dca-9bf2-483f-aefb-66734efcd19b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"my\[Theta]", "[", "num_", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Theta]", ",", "num"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"generateAnsatzCircuit", "[", 
      RowBox[{"circuitN_", ",", "nblock_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ansatz", ",", "c", ",", "blocks", ",", "paramCount"}], "}"}],
        ",", 
       RowBox[{
        RowBox[{"ansatz", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ansatz", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ansatz", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"Rx", ",", "qb"}], "]"}], "[", 
              RowBox[{"my\[Theta]", "[", 
               RowBox[{"c", "++"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"qb", ",", "0", ",", 
               RowBox[{"circuitN", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ansatz", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ansatz", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"Rz", ",", "qb"}], "]"}], "[", 
              RowBox[{"my\[Theta]", "[", 
               RowBox[{"c", "++"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"qb", ",", "0", ",", 
               RowBox[{"circuitN", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ansatz", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ansatz", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"Ry", ",", "qb"}], "]"}], "[", 
              RowBox[{"my\[Theta]", "[", 
               RowBox[{"c", "++"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"qb", ",", "0", ",", 
               RowBox[{"circuitN", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"blocks", "=", "1"}], ",", 
          RowBox[{"blocks", "<=", "nblock"}], ",", 
          RowBox[{"blocks", "++"}], ",", 
          RowBox[{
           RowBox[{"ansatz", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"ansatz", ",", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"R", "[", 
                   RowBox[{
                    RowBox[{"my\[Theta]", "[", 
                    RowBox[{"c", "++"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"Z", ",", "qb"}], "]"}], "  ", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"Z", ",", 
                    RowBox[{"qb", "+", "1"}]}], "]"}]}]}], "]"}], "}"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{"qb", ",", "0", ",", 
                   RowBox[{"circuitN", "-", "2"}]}], "}"}]}], "]"}]}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ansatz", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"ansatz", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Subscript", "[", 
                  RowBox[{"Rx", ",", "qb"}], "]"}], "[", 
                 RowBox[{"my\[Theta]", "[", 
                  RowBox[{"c", "++"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"qb", ",", "0", ",", 
                  RowBox[{"circuitN", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"ansatz", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"ansatz", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Subscript", "[", 
                  RowBox[{"Ry", ",", "qb"}], "]"}], "[", 
                 RowBox[{"my\[Theta]", "[", 
                  RowBox[{"c", "++"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"qb", ",", "0", ",", 
                  RowBox[{"circuitN", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}],
            ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"paramCount", "=", 
         RowBox[{"c", "-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "@", 
         RowBox[{"{", 
          RowBox[{"ansatz", ",", "paramCount"}], "}"}]}], ";"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"pauli", "[", 
     RowBox[{"type_", ",", "site_"}], "]"}], ":=", 
    RowBox[{"Subscript", "[", 
     RowBox[{"type", ",", "site"}], "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getListOf3LocalPaulis", "[", "numQs_", "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pauli", "[", 
             RowBox[{"type", ",", "site"}], "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"site", ",", "0", ",", 
             RowBox[{"numQs", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"type", ",", 
             RowBox[{"{", 
              RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], "}"}]}], "]"}], ",",
          "1"}], "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"pauli", "[", 
              RowBox[{"type1", ",", "site1"}], "]"}], ",", 
             RowBox[{"pauli", "[", 
              RowBox[{"type2", ",", "site2"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"site1", ",", "0", ",", 
             RowBox[{"numQs", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"site2", ",", 
             RowBox[{"site1", "+", "1"}], ",", 
             RowBox[{"numQs", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"type1", ",", 
             RowBox[{"{", 
              RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"type2", ",", 
             RowBox[{"{", 
              RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], "}"}]}], "]"}], ",",
          "3"}], "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"pauli", "[", 
              RowBox[{"type1", ",", "site1"}], "]"}], ",", 
             RowBox[{"pauli", "[", 
              RowBox[{"type2", ",", "site2"}], "]"}], ",", 
             RowBox[{"pauli", "[", 
              RowBox[{"type3", ",", "site3"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"site1", ",", "0", ",", 
             RowBox[{"numQs", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"site2", ",", 
             RowBox[{"site1", "+", "1"}], ",", 
             RowBox[{"numQs", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"site3", ",", 
             RowBox[{"site2", "+", "1"}], ",", 
             RowBox[{"numQs", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"type1", ",", 
             RowBox[{"{", 
              RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"type2", ",", 
             RowBox[{"{", 
              RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"type3", ",", 
             RowBox[{"{", 
              RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], "}"}]}], "]"}], ",",
          "5"}], "]"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localpaulis", "=", 
     RowBox[{"getListOf3LocalPaulis", "[", "numQs", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"nCONS", "=", 
     RowBox[{"Length", "@", "localpaulis"}]}], ";"}], "\n", 
   RowBox[{"Print", "@", 
    RowBox[{"Length", "@", "localpaulis"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"computeFvector", "[", 
      RowBox[{
      "\[Psi]_", ",", "\[Psi]s_", ",", "h\[Psi]_", ",", "hamil_", ",", 
       "operatorPool_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"term2s", ",", "term3", ",", "vec"}], "}"}], ",", 
       RowBox[{
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ApplyCircuit", "[", 
            RowBox[{"\[Psi]", ",", 
             RowBox[{"operatorPool", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"\[Psi]s", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"Length", "@", "operatorPool"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ApplyPauliString", "[", 
         RowBox[{"\[Psi]", ",", "hamil", ",", "h\[Psi]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"term2s", "=", 
         RowBox[{"CalcInnerProducts", "[", 
          RowBox[{"\[Psi]", ",", "\[Psi]s"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"term3", "=", 
         RowBox[{"CalcInnerProduct", "[", 
          RowBox[{"\[Psi]", ",", "h\[Psi]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vec", "=", 
         RowBox[{
          RowBox[{"Conjugate", "@", 
           RowBox[{"CalcInnerProducts", "[", 
            RowBox[{"h\[Psi]", ",", "\[Psi]s"}], "]"}]}], "-", 
          RowBox[{"term2s", "*", "term3"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Re", "@", "vec"}], ",", 
           RowBox[{"Im", "@", "vec"}]}], "]"}], "]"}], ";"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"computeJacobian", "[", 
      RowBox[{
      "\[Psi]_", ",", "\[Psi]s_", ",", "h\[Psi]_", ",", "d\[Psi]_", ",", 
       "hamil_", ",", "operatorPool_", ",", "ansatz_", ",", "params_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "term1", ",", "term2", ",", "term3", ",", "term3a", ",", "term3b", 
         ",", "en"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"ApplyCircuitDerivs", "[", 
          RowBox[{
           RowBox[{"InitZeroState", "[", "\[Psi]", "]"}], ",", "ansatz", ",", 
           "params", ",", "d\[Psi]"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ApplyCircuit", "[", 
          RowBox[{
           RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
           RowBox[{"ansatz", "/.", " ", "params"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ApplyPauliString", "[", 
          RowBox[{"\[Psi]", ",", "hamil", ",", "h\[Psi]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ApplyCircuit", "[", 
             RowBox[{"h\[Psi]", ",", 
              RowBox[{"operatorPool", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", 
              RowBox[{"\[Psi]s", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "@", "operatorPool"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"term1a", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"CalcInnerProducts", "[", 
             RowBox[{
              RowBox[{"d\[Psi]", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "\[Psi]s"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "@", "d\[Psi]"}]}], "}"}]}], "]"}]}], "    ", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"<", "d\[Psi]_k"}], "|", 
           RowBox[{
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"O", ",", "k"}], "]"}], " ", "H", " ", "\[Psi]"}], 
            ">"}]}], "*)"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ApplyCircuit", "[", 
             RowBox[{"\[Psi]", ",", 
              RowBox[{"operatorPool", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "h\[Psi]"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ApplyPauliString", "[", 
             RowBox[{"h\[Psi]", ",", "hamil", ",", 
              RowBox[{"\[Psi]s", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "@", "operatorPool"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"<", "\[Psi]"}], "|", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"O", ",", "k"}], "]"}], " ", "H"}], "|", 
           RowBox[{"d\[Psi]_k", ">"}]}], "*)"}], 
         RowBox[{"term1b", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Conjugate", "@", 
             RowBox[{"CalcInnerProducts", "[", 
              RowBox[{
               RowBox[{"d\[Psi]", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", "\[Psi]s"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "@", "d\[Psi]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"term1", "=", 
          RowBox[{"(", 
           RowBox[{"term1a", "+", "term1b"}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ApplyCircuit", "[", 
             RowBox[{"\[Psi]", ",", 
              RowBox[{"operatorPool", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", 
              RowBox[{"\[Psi]s", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "@", "operatorPool"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ApplyPauliString", "[", 
          RowBox[{"\[Psi]", ",", "hamil", ",", "h\[Psi]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"en", "=", 
          RowBox[{"CalcInnerProduct", "[", 
           RowBox[{"\[Psi]", ",", "h\[Psi]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "Re"}], "<", "\[Psi]"}], "|", 
           RowBox[{
            RowBox[{"H", " ", "\[Psi]"}], ">"}]}], "*)"}], 
         RowBox[{"term2", "=", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"2", "  ", 
              RowBox[{"Re", "@", 
               RowBox[{"CalcInnerProducts", "[", 
                RowBox[{
                 RowBox[{"d\[Psi]", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], ",", "\[Psi]s"}], "]"}]}]}],
              ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", 
               RowBox[{"Length", "@", "d\[Psi]"}]}], "}"}]}], "]"}], "*", 
           "en"}]}], "    ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "Re"}], "<", "d\[Psi]_k"}], "|", 
           RowBox[{
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"H", ",", "a"}], "]"}], " ", "\[Psi]"}], ">"}]}], 
          "*)"}], ";", "\[IndentingNewLine]", 
         RowBox[{"term3a", "=", 
          RowBox[{"CalcInnerProducts", "[", 
           RowBox[{"\[Psi]", ",", "\[Psi]s"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "Re"}], "<", "\[Psi]"}], "|", 
           RowBox[{
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"H", ",", "a"}], "]"}], " ", "\[Psi]"}], ">"}]}], 
          "*)"}], 
         RowBox[{"term3b", "=", 
          RowBox[{"2", "  ", 
           RowBox[{"Re", "[", 
            RowBox[{"CalcInnerProducts", "[", 
             RowBox[{"h\[Psi]", ",", "d\[Psi]"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"energyGradient", "=", "term3b"}], ";"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "Re"}], "<", "d\[Psi]_k"}], "|", 
          RowBox[{
           RowBox[{"H", " ", "\[Psi]"}], ">"}]}], "*)"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"term3", "=", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"term3b", ",", "term3a"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"jacobian", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"term1", "-", "term2", "-", "term3"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Re", "@", "jacobian"}], ",", 
           RowBox[{"Im", "@", "jacobian"}]}], "]"}], "]"}], ";"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.932630209975585*^9, {3.932635045387539*^9, 3.9326350554083843`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"55e6e0fb-26da-4949-814b-41d95cdac340"],

Cell[BoxData["375"], "Print",
 CellChangeTimes->{3.93565968482062*^9},
 CellLabel->
  "During evaluation of \
In[101]:=",ExpressionUUID->"e6fecbe3-34b8-44de-8461-78f9cb42abba"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{"(*", " ", 
   RowBox[{"Sample", " ", "spin", " ", "chain", " ", "Hamiltonian"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Hamil", " ", "=", " ", 
     RowBox[{
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "0"], " ", 
       SubscriptBox["X", "1"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "0"], " ", 
       SubscriptBox["X", "2"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "1"], " ", 
       SubscriptBox["X", "2"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "0"], " ", 
       SubscriptBox["X", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "1"], " ", 
       SubscriptBox["X", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "2"], " ", 
       SubscriptBox["X", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "0"], " ", 
       SubscriptBox["X", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "1"], " ", 
       SubscriptBox["X", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "2"], " ", 
       SubscriptBox["X", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "3"], " ", 
       SubscriptBox["X", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "0"], " ", 
       SubscriptBox["Y", "1"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "0"], " ", 
       SubscriptBox["Y", "2"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "1"], " ", 
       SubscriptBox["Y", "2"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "0"], " ", 
       SubscriptBox["Y", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "1"], " ", 
       SubscriptBox["Y", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "2"], " ", 
       SubscriptBox["Y", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "0"], " ", 
       SubscriptBox["Y", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "1"], " ", 
       SubscriptBox["Y", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "2"], " ", 
       SubscriptBox["Y", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "3"], " ", 
       SubscriptBox["Y", "4"]}], "-", 
      RowBox[{"0.5`", " ", 
       SubscriptBox["Z", "0"]}], "+", 
      RowBox[{"0.3`", " ", 
       SubscriptBox["Z", "1"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "0"], " ", 
       SubscriptBox["Z", "1"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "2"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "0"], " ", 
       SubscriptBox["Z", "2"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "1"], " ", 
       SubscriptBox["Z", "2"]}], "-", 
      RowBox[{"0.7`", " ", 
       SubscriptBox["Z", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "0"], " ", 
       SubscriptBox["Z", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "1"], " ", 
       SubscriptBox["Z", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "2"], " ", 
       SubscriptBox["Z", "3"]}], "+", 
      RowBox[{"0.2`", " ", 
       SubscriptBox["Z", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "0"], " ", 
       SubscriptBox["Z", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "1"], " ", 
       SubscriptBox["Z", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "2"], " ", 
       SubscriptBox["Z", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "3"], " ", 
       SubscriptBox["Z", "4"]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"High", " ", "Energy", " ", "Physics", " ", "Hamiltonian"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hamil", " ", "=", " ", 
     RowBox[{
      RowBox[{"0.05`", " ", 
       SubscriptBox["X", "0"], " ", 
       SubscriptBox["X", "1"]}], "+", 
      RowBox[{"0.05`", " ", 
       SubscriptBox["X", "1"], " ", 
       SubscriptBox["X", "2"]}], "+", 
      RowBox[{"0.05`", " ", 
       SubscriptBox["X", "2"], " ", 
       SubscriptBox["X", "3"]}], "+", 
      RowBox[{"0.05`", " ", 
       SubscriptBox["X", "3"], " ", 
       SubscriptBox["X", "4"]}], "+", 
      RowBox[{"0.05`", " ", 
       SubscriptBox["Y", "0"], " ", 
       SubscriptBox["Y", "1"]}], "+", 
      RowBox[{"0.05`", " ", 
       SubscriptBox["Y", "1"], " ", 
       SubscriptBox["Y", "2"]}], "+", 
      RowBox[{"0.05`", " ", 
       SubscriptBox["Y", "2"], " ", 
       SubscriptBox["Y", "3"]}], "+", 
      RowBox[{"0.05`", " ", 
       SubscriptBox["Y", "3"], " ", 
       SubscriptBox["Y", "4"]}], "+", 
      RowBox[{"0.45`", " ", 
       SubscriptBox["Z", "0"]}], "+", 
      RowBox[{"0.05`", " ", 
       SubscriptBox["Z", "1"]}], "+", 
      RowBox[{"1.5`", " ", 
       SubscriptBox["Z", "0"], " ", 
       SubscriptBox["Z", "1"]}], "+", 
      RowBox[{"0.45`", " ", 
       SubscriptBox["Z", "2"]}], "+", 
      RowBox[{"1.`", " ", 
       SubscriptBox["Z", "0"], " ", 
       SubscriptBox["Z", "2"]}], "+", 
      RowBox[{"1.`", " ", 
       SubscriptBox["Z", "1"], " ", 
       SubscriptBox["Z", "2"]}], "+", 
      RowBox[{"0.05`", " ", 
       SubscriptBox["Z", "3"]}], "+", 
      RowBox[{"0.5`", " ", 
       SubscriptBox["Z", "0"], " ", 
       SubscriptBox["Z", "3"]}], "+", 
      RowBox[{"0.5`", " ", 
       SubscriptBox["Z", "1"], " ", 
       SubscriptBox["Z", "3"]}], "+", 
      RowBox[{"0.5`", " ", 
       SubscriptBox["Z", "2"], " ", 
       SubscriptBox["Z", "3"]}], "-", 
      RowBox[{"0.05`", " ", 
       SubscriptBox["Z", "4"]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hamilO", "[", 
      RowBox[{"numQs_", ",", " ", "t_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "hamil", "}"}], ",", 
       RowBox[{
        RowBox[{"hamil", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "t"}], ")"}], "*", 
            RowBox[{"Subscript", "[", 
             RowBox[{"X", ",", 
              RowBox[{"k", "-", "1"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "numQs"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "@", "hamil"}], ";"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeHamil", "[", 
      RowBox[{"Hamil_", ",", " ", "t_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "hamil", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"hamil", "=", 
         RowBox[{"hamilO", "[", 
          RowBox[{"numQs", ",", " ", "t"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hamil", "+=", 
         RowBox[{"t", "*", "Hamil"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "@", "hamil"}], ";"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.932630628173092*^9, 3.93263062992837*^9}, 
   3.932630895911252*^9, {3.932631017192005*^9, 3.932631164659758*^9}, {
   3.93263192357892*^9, 3.932631925961972*^9}, 3.932635051196459*^9, {
   3.933839059658927*^9, 3.933839087234366*^9}, {3.9338406785240297`*^9, 
   3.9338406977826433`*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"0b4d135e-e348-4875-86e4-355fe52690f2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ansatz", ",", "numParams"}], "}"}], "=", 
   RowBox[{"generateAnsatzCircuit", "[", 
    RowBox[{"numQs", ",", "layers"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<number of parameters:\>\"", ",", " ", "numParams"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"CreateQureg", "[", "numQs", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h\[Psi]", "=", 
   RowBox[{"CreateQureg", "[", "numQs", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Psi]", "=", 
   RowBox[{"CreateQuregs", "[", 
    RowBox[{"numQs", ",", "numParams"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]s", "=", 
    RowBox[{"CreateQuregs", "[", 
     RowBox[{"numQs", ",", "nCONS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"MORPHING", " ", "PARAM"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "adjust", " ", "initial", " ", "parameters", " ", "to", " ", "change", " ",
     "the", " ", "target", " ", "energy", " ", "level"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{"\[Theta]", ",", "k"}], "]"}], "->", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "numQs"}], "+", "1"}], "<=", "k", "<=", " ", 
          RowBox[{"3", "*", "numQs"}]}], " ", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"k", "==", "12"}], "||", 
            RowBox[{"k", "==", "11"}]}], ",", 
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}], ",", "0"}], "]"}]}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "numParams"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Theta]", ",", "k"}], "]"}], "->", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"2", "*", "numQs"}], "+", "1"}], "<=", "k", "<=", " ", 
           RowBox[{"3", "*", "numQs"}]}], " ", ",", "\[Pi]", ",", "0"}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "numParams"}], "}"}]}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"randomStep", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Theta]", ",", "k"}], "]"}], "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "500"}], ",", 
         RowBox[{"\[Pi]", "/", "500"}]}], "}"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "numParams"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"params", "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", "2"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"params", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "2"}], "]"}], "]"}], "+", 
     RowBox[{"randomStep", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"CreateQureg", "[", "numQs", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplyCircuit", "[", 
   RowBox[{
    RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
    RowBox[{"ansatz", "/.", " ", "params"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"params", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hamil", " ", "=", " ", 
   RowBox[{"ExpandAll", "@", 
    RowBox[{"Chop", "@", 
     RowBox[{"timeHamil", "[", 
      RowBox[{"Hamil", ",", " ", "0"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hamilmat", "=", 
   RowBox[{"CalcPauliStringMatrix", "[", "hamil", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"realEnergy", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Eigenvalues", "@", "hamilmat"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eigenvec", " ", "=", " ", 
    RowBox[{"Eigenvectors", "@", "hamilmat"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalIter", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ansatz", "/.", " ", "params"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetQuregMatrix", "[", "\[Psi]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplyPauliString", "[", 
   RowBox[{"\[Psi]", ",", "hamil", ",", "h\[Psi]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"Chop", "@", 
    RowBox[{"CalcInnerProduct", "[", 
     RowBox[{"h\[Psi]", ",", "\[Psi]"}], "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<energy computed:\>\"", ",", " ", "energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<actual E:\>\"", ",", " ", "realEnergy"}], "]"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalHamil", " ", "=", " ", 
   RowBox[{"ExpandAll", "@", 
    RowBox[{"Chop", "@", 
     RowBox[{"timeHamil", "[", 
      RowBox[{"Hamil", ",", " ", "1.0"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Final hamil:\>\"", ",", " ", "finalHamil"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9326311812207623`*^9, 3.9326312812124577`*^9}, 
   3.932631320091906*^9, {3.932632769620615*^9, 3.932632786597838*^9}, {
   3.93383910442583*^9, 3.933839136671321*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"eb1c114d-a4dc-423a-a184-ddc84d5b6b4f"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"number of parameters:\"\>", "\[InvisibleSpace]", "113"}],
  SequenceForm["number of parameters:", 113],
  Editable->False]], "Print",
 CellChangeTimes->{3.935659689548023*^9, 3.935659919034182*^9},
 CellLabel->
  "During evaluation of \
In[177]:=",ExpressionUUID->"6043e767-f130-47c0-b4ce-7c58eaa4ec57"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"energy computed:\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "4.999335187567845`"}]}],
  SequenceForm["energy computed:", -4.999335187567845],
  Editable->False]], "Print",
 CellChangeTimes->{3.935659689548023*^9, 3.935659919048624*^9},
 CellLabel->
  "During evaluation of \
In[177]:=",ExpressionUUID->"0c01d41a-2362-4356-b914-415d1c6e4d81"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"actual E:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.9999999999999964`"}], ",", 
     RowBox[{"-", "3.000000000000002`"}], ",", 
     RowBox[{"-", "3.0000000000000013`"}], ",", 
     RowBox[{"-", "3.0000000000000004`"}], ",", 
     RowBox[{"-", "2.9999999999999996`"}], ",", 
     RowBox[{"-", "2.9999999999999973`"}], ",", 
     RowBox[{"-", "1.0000000000000016`"}], ",", 
     RowBox[{"-", "1.0000000000000002`"}], ",", 
     RowBox[{"-", "1.`"}], ",", 
     RowBox[{"-", "0.9999999999999999`"}], ",", 
     RowBox[{"-", "0.9999999999999999`"}], ",", 
     RowBox[{"-", "0.9999999999999998`"}], ",", 
     RowBox[{"-", "0.9999999999999993`"}], ",", 
     RowBox[{"-", "0.999999999999999`"}], ",", 
     RowBox[{"-", "0.999999999999998`"}], ",", 
     RowBox[{"-", "0.9999999999999979`"}], ",", "0.9999999999999972`", ",", 
     "0.9999999999999991`", ",", "0.9999999999999996`", ",", 
     "0.9999999999999996`", ",", "0.9999999999999996`", ",", 
     "1.0000000000000002`", ",", "1.0000000000000002`", ",", 
     "1.0000000000000007`", ",", "1.0000000000000007`", ",", 
     "1.0000000000000013`", ",", "2.9999999999999973`", ",", 
     "2.9999999999999982`", ",", "2.9999999999999996`", ",", 
     "3.0000000000000013`", ",", "3.0000000000000018`", ",", 
     "4.9999999999999964`"}], "}"}]}],
  SequenceForm[
  "actual E:", {-4.9999999999999964`, -3.000000000000002, \
-3.0000000000000013`, -3.0000000000000004`, -2.9999999999999996`, \
-2.9999999999999973`, -1.0000000000000016`, -1.0000000000000002`, -1., \
-0.9999999999999999, -0.9999999999999999, -0.9999999999999998, \
-0.9999999999999993, -0.999999999999999, -0.999999999999998, \
-0.9999999999999979, 0.9999999999999972, 0.9999999999999991, 
   0.9999999999999996, 0.9999999999999996, 0.9999999999999996, 
   1.0000000000000002`, 1.0000000000000002`, 1.0000000000000007`, 
   1.0000000000000007`, 1.0000000000000013`, 2.9999999999999973`, 
   2.9999999999999982`, 2.9999999999999996`, 3.0000000000000013`, 
   3.0000000000000018`, 4.9999999999999964`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.935659689548023*^9, 3.935659919049593*^9},
 CellLabel->
  "During evaluation of \
In[177]:=",ExpressionUUID->"80546890-bff9-4e18-a300-f5be9275c403"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final hamil:\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"0.05`", " ", 
     SubscriptBox["X", "0"], " ", 
     SubscriptBox["X", "1"]}], "+", 
    RowBox[{"0.05`", " ", 
     SubscriptBox["X", "1"], " ", 
     SubscriptBox["X", "2"]}], "+", 
    RowBox[{"0.05`", " ", 
     SubscriptBox["X", "2"], " ", 
     SubscriptBox["X", "3"]}], "+", 
    RowBox[{"0.05`", " ", 
     SubscriptBox["X", "3"], " ", 
     SubscriptBox["X", "4"]}], "+", 
    RowBox[{"0.05`", " ", 
     SubscriptBox["Y", "0"], " ", 
     SubscriptBox["Y", "1"]}], "+", 
    RowBox[{"0.05`", " ", 
     SubscriptBox["Y", "1"], " ", 
     SubscriptBox["Y", "2"]}], "+", 
    RowBox[{"0.05`", " ", 
     SubscriptBox["Y", "2"], " ", 
     SubscriptBox["Y", "3"]}], "+", 
    RowBox[{"0.05`", " ", 
     SubscriptBox["Y", "3"], " ", 
     SubscriptBox["Y", "4"]}], "+", 
    RowBox[{"0.45`", " ", 
     SubscriptBox["Z", "0"]}], "+", 
    RowBox[{"0.05`", " ", 
     SubscriptBox["Z", "1"]}], "+", 
    RowBox[{"1.5`", " ", 
     SubscriptBox["Z", "0"], " ", 
     SubscriptBox["Z", "1"]}], "+", 
    RowBox[{"0.45`", " ", 
     SubscriptBox["Z", "2"]}], "+", 
    RowBox[{"1.`", " ", 
     SubscriptBox["Z", "0"], " ", 
     SubscriptBox["Z", "2"]}], "+", 
    RowBox[{"1.`", " ", 
     SubscriptBox["Z", "1"], " ", 
     SubscriptBox["Z", "2"]}], "+", 
    RowBox[{"0.05`", " ", 
     SubscriptBox["Z", "3"]}], "+", 
    RowBox[{"0.5`", " ", 
     SubscriptBox["Z", "0"], " ", 
     SubscriptBox["Z", "3"]}], "+", 
    RowBox[{"0.5`", " ", 
     SubscriptBox["Z", "1"], " ", 
     SubscriptBox["Z", "3"]}], "+", 
    RowBox[{"0.5`", " ", 
     SubscriptBox["Z", "2"], " ", 
     SubscriptBox["Z", "3"]}], "-", 
    RowBox[{"0.05`", " ", 
     SubscriptBox["Z", "4"]}]}]}],
  SequenceForm[
  "Final hamil:", 0.05 Subscript[QuEST`Gate`X, 0] Subscript[QuEST`Gate`X, 1] + 
   0.05 Subscript[QuEST`Gate`X, 1] Subscript[QuEST`Gate`X, 2] + 
   0.05 Subscript[QuEST`Gate`X, 2] Subscript[QuEST`Gate`X, 3] + 
   0.05 Subscript[QuEST`Gate`X, 3] Subscript[QuEST`Gate`X, 4] + 
   0.05 Subscript[QuEST`Gate`Y, 0] Subscript[QuEST`Gate`Y, 1] + 
   0.05 Subscript[QuEST`Gate`Y, 1] Subscript[QuEST`Gate`Y, 2] + 
   0.05 Subscript[QuEST`Gate`Y, 2] Subscript[QuEST`Gate`Y, 3] + 
   0.05 Subscript[QuEST`Gate`Y, 3] Subscript[QuEST`Gate`Y, 4] + 
   0.45 Subscript[QuEST`Gate`Z, 0] + 0.05 Subscript[QuEST`Gate`Z, 1] + 
   1.5 Subscript[QuEST`Gate`Z, 0] Subscript[QuEST`Gate`Z, 1] + 
   0.45 Subscript[QuEST`Gate`Z, 2] + 
   1. Subscript[QuEST`Gate`Z, 0] Subscript[QuEST`Gate`Z, 2] + 
   1. Subscript[QuEST`Gate`Z, 1] Subscript[QuEST`Gate`Z, 2] + 
   0.05 Subscript[QuEST`Gate`Z, 3] + 
   0.5 Subscript[QuEST`Gate`Z, 0] Subscript[QuEST`Gate`Z, 3] + 
   0.5 Subscript[QuEST`Gate`Z, 1] Subscript[QuEST`Gate`Z, 3] + 
   0.5 Subscript[QuEST`Gate`Z, 2] Subscript[QuEST`Gate`Z, 3] - 0.05 
   Subscript[QuEST`Gate`Z, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{3.935659689548023*^9, 3.935659919050755*^9},
 CellLabel->
  "During evaluation of \
In[177]:=",ExpressionUUID->"64fc2cec-4507-4175-8e60-75fb411f4e73"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"paramsList", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"realEnergyList", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covarEnergy", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TargetEnergyList", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myVecNorms", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"t", "==", "1.0"}], ",", 
          RowBox[{"iter", "=", "50"}], ",", 
          RowBox[{"iter", "=", "25"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"hamil", " ", "=", " ", 
         RowBox[{"ExpandAll", "@", 
          RowBox[{"Chop", "@", 
           RowBox[{"timeHamil", "[", 
            RowBox[{"Hamil", ",", " ", "t"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Do", "[", 
            RowBox[{"(*", 
             RowBox[{"Usually", ",", 
              RowBox[{
              "you", " ", "would", " ", "sample", " ", "from", " ", "the", 
               " ", "operator", " ", "pool"}], ",", 
              RowBox[{
              "but", " ", "for", " ", "5", " ", "qubits", " ", "it", " ", 
               "is", " ", "small", " ", "enough", " ", "that", " ", "we", " ",
                "can", " ", "use", " ", "all", " ", "of", " ", "it"}]}], 
             "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"operatorPool", "=", 
               RowBox[{"RandomSample", "[", 
                RowBox[{"localpaulis", ",", " ", "nCONS"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"vec", "=", 
               RowBox[{"computeFvector", "[", 
                RowBox[{
                "\[Psi]", ",", "\[Psi]s", ",", "h\[Psi]", ",", "hamil", ",", 
                 " ", "operatorPool"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"jacobian", "=", 
               RowBox[{"computeJacobian", "[", 
                RowBox[{
                "\[Psi]", ",", " ", "\[Psi]s", ",", "h\[Psi]", ",", "d\[Psi]",
                  ",", "hamil", ",", "operatorPool", ",", "ansatz", ",", 
                 "params"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"vecDim", " ", "=", " ", 
               RowBox[{"Dimensions", "[", "vec", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"jacDim", " ", "=", " ", 
               RowBox[{"Dimensions", "[", "jacobian", "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", " ", "shot", " ", "noise", " ", "simulation"}],
                 ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"add", "\[IndentingNewLine]", "vec"}], " ", "=", 
                  " ", 
                  RowBox[{"vec", " ", "+", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"1", "/", 
                    RowBox[{"10", "^", "3"}]}]}], "]"}], ",", " ", "vecDim"}],
                     "]"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"jacobian", " ", "=", " ", 
                  RowBox[{"jacobian", " ", "+", " ", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"1", "/", 
                    RowBox[{"10", "^", "3"}]}]}], "]"}], ",", " ", "jacDim"}],
                     "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"myVecNorms", ",", 
                RowBox[{
                 RowBox[{"Norm", "[", "vec", "]"}], "^", "2"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"myVecNorms", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], " ", "==", " ", 
                 RowBox[{"myVecNorms", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "2"}], "]"}], "]"}]}], ",", " ", 
                RowBox[{
                 RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "Calculate", " ", "step", " ", "from", " ", "jacobian", " ", 
                "and", " ", "F", " ", "vector", " ", "with", " ", 
                "regularisation"}], "*)"}], " ", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"eta", "=", 
                  RowBox[{"0.0001", "*", 
                   RowBox[{"2", "^", "etaIT"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"jtj", "=", 
                  RowBox[{
                   RowBox[{"Transpose", "[", "jacobian", "]"}], ".", 
                   "jacobian"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"stepvec", "=", 
                  RowBox[{
                   RowBox[{"-", "0.5"}], 
                   RowBox[{
                    RowBox[{"Inverse", "[", 
                    RowBox[{"jtj", "+", 
                    RowBox[{"eta", "*", 
                    RowBox[{"DiagonalMatrix", "@", 
                    RowBox[{"Diagonal", "@", "jtj"}]}]}]}], "]"}], ".", 
                    RowBox[{"Transpose", "[", "jacobian", "]"}], ".", 
                    "vec"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Max", "@", 
                    RowBox[{"Abs", "@", "stepvec"}]}], ">", "1"}], ",", 
                   RowBox[{"stepvec", "=", 
                    RowBox[{"stepvec", "/", 
                    RowBox[{"Max", "@", 
                    RowBox[{"Abs", "@", "stepvec"}]}]}]}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"paramsTST", "=", "params"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"paramsTST", "[", 
                   RowBox[{"[", 
                    RowBox[{";;", ",", "2"}], "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"paramsTST", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "2"}], "]"}], "]"}], "+", 
                   "stepvec"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"ApplyCircuit", "[", 
                  RowBox[{
                   RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
                   RowBox[{"ansatz", "/.", "paramsTST"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"newNORM", "=", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"computeFvector", "[", 
                    RowBox[{
                    "\[Psi]", ",", "\[Psi]s", ",", "h\[Psi]", ",", "hamil", 
                    ",", " ", "operatorPool"}], "]"}], "]"}], "^", "2"}]}], 
                 ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"newNORM", "<", 
                    RowBox[{"myVecNorms", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"Break", "[", "]"}], ";"}]}], "]"}]}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"etaIT", ",", "0", ",", "10"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Update", " ", "parameters"}], "*)"}], 
              RowBox[{
               RowBox[{"params", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "2"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"params", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "2"}], "]"}], "]"}], "+", "stepvec"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"ansatz", "/.", " ", "params"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"ApplyCircuit", "[", 
               RowBox[{
                RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
                RowBox[{"ansatz", "/.", "params"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"energy", " ", "=", " ", 
               RowBox[{"CalcExpecPauliString", "[", 
                RowBox[{"\[Psi]", ",", " ", "hamil", ",", " ", "h\[Psi]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"paramsList", ",", "params"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"realEnergyList", ",", " ", "energy"}], "]"}], ";"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"step", ",", "1", ",", "iter"}], "}"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"ListLinePlot", "[", 
             RowBox[{"realEnergyList", ",", " ", 
              RowBox[{"ImageSize", "\[Rule]", "300"}], ",", " ", 
              RowBox[{"AxesLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<Iteration\>\"", ",", "\"\<Energy\>\""}], 
                "}"}]}]}], "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"realEnergyList", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"realEnergy", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"Eigenvalues", "@", 
           RowBox[{"CalcPauliStringMatrix", "[", "hamil", "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ansatz", "/.", " ", "params"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ApplyCircuit", "[", 
         RowBox[{
          RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
          RowBox[{"ansatz", "/.", "params"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"energy", " ", "=", " ", 
         RowBox[{"CalcExpecPauliString", "[", 
          RowBox[{"\[Psi]", ",", " ", "hamil", ",", " ", "h\[Psi]"}], "]"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"covarEnergy", ",", "energy"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"TargetEnergyList", ",", " ", 
          RowBox[{"realEnergy", "[", 
           RowBox[{"[", "TargetEnergyLevel", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"totalIter", " ", "=", " ", 
         RowBox[{"totalIter", " ", "+", "1"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "start", ",", "1", ",", "deltaT"}], "}"}]}], "]"}], 
     ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"covarEnergy", ",", " ", "TargetEnergyList"}], "}"}], ",", 
        " ", 
        RowBox[{"ImageSize", "\[Rule]", "300"}], ",", " ", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Time\>\"", ",", "\"\<Energy\>\""}], "}"}]}]}], "]"}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Row", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"realEnergyList", ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", "300"}], ",", " ", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Iteration\>\"", ",", "\"\<Energy\>\""}], "}"}]}]}], 
      "]"}], ",", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"covarEnergy", ",", " ", "TargetEnergyList"}], "}"}], ",", 
       " ", 
       RowBox[{"ImageSize", "\[Rule]", "300"}], ",", " ", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<time\>\"", ",", "\"\<Energy\>\""}], "}"}]}]}], "]"}]}], 
    "}"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Final", " ", "comparison"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hamil", " ", "=", " ", 
   RowBox[{"ExpandAll", "@", 
    RowBox[{"Chop", "@", 
     RowBox[{"timeHamil", "[", 
      RowBox[{"Hamil", ",", " ", "1.0"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hamilmat", "=", 
   RowBox[{"CalcPauliStringMatrix", "[", "hamil", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"realEnergy", "=", 
   RowBox[{"Sort", "@", 
    RowBox[{"Eigenvalues", "@", "hamilmat"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<actual e:\>\"", ",", " ", 
    RowBox[{"realEnergy", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<CoVAR e:\>\"", ",", " ", "energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.932631303939684*^9, 3.9326314712827253`*^9}, {
   3.93263151486057*^9, 3.932631529564864*^9}, {3.932631562713439*^9, 
   3.9326315676212673`*^9}, {3.932631601966617*^9, 3.932631721754529*^9}, {
   3.932631759521394*^9, 3.932631764905424*^9}, {3.9326318077159033`*^9, 
   3.9326318082630243`*^9}, {3.932631863433724*^9, 3.932631893176697*^9}, {
   3.932631970099104*^9, 3.932631972592104*^9}, {3.932632009715679*^9, 
   3.932632022074195*^9}, {3.933755358758293*^9, 3.933755365029451*^9}, {
   3.9338391647149353`*^9, 3.933839226146173*^9}, {3.933839294412272*^9, 
   3.933839298743971*^9}, {3.933839391239233*^9, 3.933839411208666*^9}, {
   3.933839452039744*^9, 3.9338394525442133`*^9}, {3.9338395391516047`*^9, 
   3.933839539666109*^9}, {3.933840759629264*^9, 3.9338407626959763`*^9}, {
   3.935659393901094*^9, 3.935659396103733*^9}, {3.9356594337794647`*^9, 
   3.935659434420403*^9}, {3.9356594985728493`*^9, 3.935659500052619*^9}, {
   3.935659813348201*^9, 3.935659828474327*^9}, 3.935659910327281*^9},
 CellLabel->
  "In[202]:=",ExpressionUUID->"46f15645-9604-4777-82fe-7414dc24774c"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"-\\\", \\\"2\\\"}]\\) of \
\\!\\(\\*RowBox[{\\\"{\\\", \\\"0.9413322052259097`\\\", \\\"}\\\"}]\\) does \
not exist.\"", 2, 207, 37, 18433722946922128711, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9356596920737343`*^9, 3.935659921841189*^9},
 CellLabel->
  "During evaluation of \
In[202]:=",ExpressionUUID->"11d550e1-d53c-4b01-b5d4-00b31aa7e31a"],

Cell[BoxData[
 TemplateBox[{
  "Inverse", "luc", 
   "\"Result for \\!\\(\\*RowBox[{\\\"Inverse\\\"}]\\) of badly conditioned \
matrix \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"18.004256460510142`\\\", \\\",\\\", \\\"2.3239036072574946`\\\", \
\\\",\\\", \\\"1.529616290922374`\\\", \\\",\\\", \
\\\"0.7693622220348539`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"0.006121971645033008`\\\"}], \\\",\\\", \\\"8.37784723275403`*^-6\\\", \\\
\",\\\", \\\"0.000019697640607257204`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"0.000039597533585550114`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"0.00011054659088030194`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.5064535997717307`*^-6\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"103\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"9\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"103\\\
\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]\\) may contain significant \
numerical errors.\"", 2, 207, 38, 18433722946922128711, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9356596920737343`*^9, 3.935659921846158*^9},
 CellLabel->
  "During evaluation of \
In[202]:=",ExpressionUUID->"d2b480f9-6e63-47ac-a833-fd8647e9525b"],

Cell[BoxData[
 TemplateBox[{
  "Inverse", "luc", 
   "\"Result for \\!\\(\\*RowBox[{\\\"Inverse\\\"}]\\) of badly conditioned \
matrix \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"18.02214384515932`\\\", \\\",\\\", \\\"2.27267447953946`\\\", \
\\\",\\\", \\\"1.5484229448912374`\\\", \\\",\\\", \
\\\"0.6892012422304328`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"0.004831037740790702`\\\"}], \\\",\\\", \\\"0.000324695572140197`\\\", \\\
\",\\\", RowBox[{\\\"-\\\", \\\"0.0032225481349805445`\\\"}], \\\",\\\", \
\\\"0.0011694016528842424`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"0.0022294597227290767`\\\"}], \\\",\\\", \\\"2.3238129780665314`*^-6\\\", \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"103\\\", \\\"\[RightSkeleton]\
\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"9\\\", \
\\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"103\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]\\) may contain \
significant numerical errors.\"", 2, 207, 39, 18433722946922128711, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9356596920737343`*^9, 3.935659922348228*^9},
 CellLabel->
  "During evaluation of \
In[202]:=",ExpressionUUID->"728fc431-50f2-4985-8ed7-d978d8b1cc40"],

Cell[BoxData[
 TemplateBox[{
  "Inverse", "luc", 
   "\"Result for \\!\\(\\*RowBox[{\\\"Inverse\\\"}]\\) of badly conditioned \
matrix \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"18.027297388237407`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"0.5080383886049289`\\\"}], \\\",\\\", \\\"0.1489655876376312`\\\", \
\\\",\\\", \\\"0.22671904598797465`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"0.003496138048484032`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"0.00033518763999730485`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"0.012877840957765875`\\\"}], \\\",\\\", \\\"0.0016272613550065065`\\\", \
\\\",\\\", \\\"0.004229696028376374`\\\", \\\",\\\", \
\\\"4.481211846857896`*^-7\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"103\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\
\"\[LeftSkeleton]\\\", \\\"9\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"103\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}]\\) may contain significant numerical errors.\"", 2, 207, 40, 
   18433722946922128711, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9356596920737343`*^9, 3.9356599228503437`*^9},
 CellLabel->
  "During evaluation of \
In[202]:=",ExpressionUUID->"cb7661c3-55a3-4f0a-9cec-fcd35a53ec2c"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Inverse\\\", \
\\\"::\\\", \\\"luc\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 207, 41, 18433722946922128711, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9356596920737343`*^9, 3.935659922852996*^9},
 CellLabel->
  "During evaluation of \
In[202]:=",ExpressionUUID->"19d86774-89e2-4335-b943-4c768a9f27fa"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{}, {
    DisplayFunction -> Identity, Axes -> {True, True}, AxesLabel -> {
       FormBox[
        TagBox["\"Iteration\"", HoldForm], TraditionalForm], 
       FormBox[
        TagBox["\"Energy\"", HoldForm], TraditionalForm]}, 
     AxesOrigin -> {0, 0}, DisplayFunction -> Identity, 
     Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], ImageSize -> 300, 
     Method -> {
      "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
         Directive[
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.560181, 0.691569, 0.194885], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.922526, 0.385626, 0.209179], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.528488, 0.470624, 0.701351], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.772079, 0.431554, 0.102387], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.363898, 0.618501, 0.782349], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[1, 0.75, 0], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.647624, 0.37816, 0.614037], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.571589, 0.586483, 0.], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.915, 0.3325, 0.2125], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[
          0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
          AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
       "RangePadding" -> Scaled[0.05], "MessagesHead" -> ListLinePlot, 
       "DownsampleWindow" -> None, "OptimizePlotMarkers" -> True, 
       "IncludeHighlighting" -> "CurrentSet", "HighlightStyle" -> Automatic, 
       "MessagesHead" -> ListLinePlot, "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& )}}, PlotRange -> {{-1, 1}, {-1, 1}}, 
     PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}, AlignmentPoint -> 
     Center, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> True, AxesLabel -> None, AxesOrigin -> Automatic, 
     AxesStyle -> {}, Background -> None, BaselinePosition -> Automatic, 
     BaseStyle -> {}, ColorOutput -> Automatic, ContentSelectable -> 
     Automatic, CoordinatesToolOptions -> Automatic, 
     DisplayFunction :> $DisplayFunction, Epilog -> {}, FormatType :> 
     TraditionalForm, Frame -> False, FrameLabel -> None, FrameStyle -> {}, 
     FrameTicks -> Automatic, FrameTicksStyle -> {}, GridLines -> None, 
     GridLinesStyle -> {}, ImageMargins -> 0., ImagePadding -> All, ImageSize -> 
     Automatic, ImageSizeRaw -> Automatic, LabelStyle -> {}, Method -> 
     Automatic, PlotLabel -> None, PlotRange -> Automatic, PlotRangeClipping -> 
     True, PlotRangePadding -> Automatic, PlotRegion -> Automatic, 
     PreserveImageOptions -> Automatic, Prolog -> {}, RotateLabel -> True, 
     Ticks -> Automatic, TicksStyle -> {}}], 
   GraphicsBox[{{}, 
     InterpretationBox[{
       TagBox[{{{}, {}, 
          TagBox[{
            Hue[0.67, 0.6, 0.6], 
            Directive[
             PointSize[
              NCache[
               Rational[7, 360], 0.019444444444444445`]], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]], 
            
            LineBox[{{1., -4.4940270577453}, {2., -3.7928274287031907`}, {
             3., -3.177629683538732}, {4., -2.7043357316831056`}, {
             5., -2.5014168747828758`}, {6., -2.5957361468132123`}, {
             7., -2.8799979414465704`}}]}, 
           Annotation[#, "Charting`Private`Tag#1"]& ], 
          TagBox[{
            Hue[0.9060679774997897, 0.6, 0.6], 
            Directive[
             PointSize[
              NCache[
               Rational[7, 360], 0.019444444444444445`]], 
             RGBColor[0.880722, 0.611041, 0.142051], 
             AbsoluteThickness[2]], 
            
            LineBox[{{1., -4.494177869514107}, {2., -3.7930119394036867`}, {
             3., -3.177630135769413}, {4., -2.70433648711545}, {
             5., -2.5015814696786745`}, {6., -2.595740323506319}, {
             7., -2.879999400813601}}]}, 
           Annotation[#, "Charting`Private`Tag#2"]& ]}}, {
        "WolframDynamicHighlight", <|
         "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
       DynamicBox[
        (Charting`HighlightActionBox["DynamicHighlight", {}, 
         Slot["HighlightElements"], 
         Slot["LayoutOptions"], 
         Slot["Meta"], 
         Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
            Annotation[{
              Hue[0.67, 0.6, 0.6], 
              Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.368417, 0.506779, 0.709798], 
               AbsoluteThickness[2]], 
              
              Line[{{1., -4.4940270577453}, {2., -3.7928274287031907`}, {
               3., -3.177629683538732}, {4., -2.7043357316831056`}, {
               5., -2.5014168747828758`}, {6., -2.5957361468132123`}, {
               7., -2.8799979414465704`}}]}, "Charting`Private`Tag#1"], 
            Annotation[{
              Hue[0.9060679774997897, 0.6, 0.6], 
              Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.880722, 0.611041, 0.142051], 
               AbsoluteThickness[2]], 
              
              Line[{{1., -4.494177869514107}, {2., -3.7930119394036867`}, {
               3., -3.177630135769413}, {4., -2.70433648711545}, {
               5., -2.5015814696786745`}, {6., -2.595740323506319}, {
               7., -2.879999400813601}}]}, "Charting`Private`Tag#2"]}}, <|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
           "LayoutOptions" -> <|
            "PlotRange" -> {{0., 
              7.}, {-4.494177869514107, -2.5014168747828758`}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {0., -2.3907079306311463`}, 
             "ImageSize" -> {300, 300/GoldenRatio}, "Axes" -> {True, True}, 
             "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
             "DefaultStyle" -> {
               Directive[
                PointSize[
                 Rational[7, 360]], 
                RGBColor[0.880722, 0.611041, 0.142051], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[
                 Rational[7, 360]], 
                RGBColor[0.368417, 0.506779, 0.709798], 
                AbsoluteThickness[2]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 Identity[
                  Part[#, 1]], 
                 Identity[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>]]& )[<|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
          "LayoutOptions" -> <|
           "PlotRange" -> {{0., 
             7.}, {-4.494177869514107, -2.5014168747828758`}}, 
            "Frame" -> {{False, False}, {False, False}}, 
            "AxesOrigin" -> {0., -2.3907079306311463`}, 
            "ImageSize" -> {300, 300/GoldenRatio}, "Axes" -> {True, True}, 
            "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
            "DefaultStyle" -> {
              Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.880722, 0.611041, 0.142051], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.368417, 0.506779, 0.709798], 
               AbsoluteThickness[2]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                Identity[
                 Part[#, 1]], 
                Identity[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            ListLinePlot, "GroupHighlight" -> False|>|>]]}, 
      Annotation[{{{}, {}, 
         Annotation[{
           Hue[0.67, 0.6, 0.6], 
           Directive[
            PointSize[
             Rational[7, 360]], 
            RGBColor[0.368417, 0.506779, 0.709798], 
            AbsoluteThickness[2]], 
           
           Line[{{1., -4.4940270577453}, {2., -3.7928274287031907`}, {
            3., -3.177629683538732}, {4., -2.7043357316831056`}, {
            5., -2.5014168747828758`}, {6., -2.5957361468132123`}, {
            7., -2.8799979414465704`}}]}, "Charting`Private`Tag#1"], 
         Annotation[{
           Hue[0.9060679774997897, 0.6, 0.6], 
           Directive[
            PointSize[
             Rational[7, 360]], 
            RGBColor[0.880722, 0.611041, 0.142051], 
            AbsoluteThickness[2]], 
           
           Line[{{1., -4.494177869514107}, {2., -3.7930119394036867`}, {
            3., -3.177630135769413}, {4., -2.70433648711545}, {
            5., -2.5015814696786745`}, {6., -2.595740323506319}, {
            7., -2.879999400813601}}]}, "Charting`Private`Tag#2"]}}, <|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
        "LayoutOptions" -> <|
         "PlotRange" -> {{0., 
           7.}, {-4.494177869514107, -2.5014168747828758`}}, 
          "Frame" -> {{False, False}, {False, False}}, 
          "AxesOrigin" -> {0., -2.3907079306311463`}, 
          "ImageSize" -> {300, 300/GoldenRatio}, "Axes" -> {True, True}, 
          "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
          "DefaultStyle" -> {
            Directive[
             PointSize[
              Rational[7, 360]], 
             RGBColor[0.880722, 0.611041, 0.142051], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[
              Rational[7, 360]], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              Identity[
               Part[#, 1]], 
              Identity[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          ListLinePlot, "GroupHighlight" -> False|>|>, 
       "DynamicHighlight"]], {{}, {}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, DisplayFunction -> 
     Identity, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {
       FormBox[
        TagBox["\"time\"", HoldForm], TraditionalForm], 
       FormBox[
        TagBox["\"Energy\"", HoldForm], TraditionalForm]}, 
     AxesOrigin -> {0., -2.3907079306311463`}, DisplayFunction :> Identity, 
     Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], ImageSize -> 300, 
     Method -> {
      "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
         Directive[
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.560181, 0.691569, 0.194885], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.922526, 0.385626, 0.209179], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.528488, 0.470624, 0.701351], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.772079, 0.431554, 0.102387], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.363898, 0.618501, 0.782349], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[1, 0.75, 0], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.647624, 0.37816, 0.614037], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.571589, 0.586483, 0.], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.915, 0.3325, 0.2125], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[
          0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
          AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
       "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
       "IncludeHighlighting" -> "CurrentSet", "HighlightStyle" -> Automatic, 
       "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{0., 7.}, {-4.494177869514107, -2.5014168747828758`}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}]},
  "RowDefault"]], "Output",
 CellChangeTimes->{3.9356597921952877`*^9, 3.935660024809349*^9},
 CellLabel->
  "Out[208]=",ExpressionUUID->"a15cd53c-08f1-47a6-9323-0b1003915cd5"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"actual e:\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2.879999400813601`"}]}],
  SequenceForm["actual e:", -2.879999400813601],
  Editable->False]], "Print",
 CellChangeTimes->{3.935659792216988*^9, 3.935660024829077*^9},
 CellLabel->
  "During evaluation of \
In[202]:=",ExpressionUUID->"273552e8-6123-47f4-b62c-3d378dd4cc18"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"CoVAR e:\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2.8799979414465704`"}]}],
  SequenceForm["CoVAR e:", -2.8799979414465704`],
  Editable->False]], "Print",
 CellChangeTimes->{3.935659792216988*^9, 3.935660024829541*^9},
 CellLabel->
  "During evaluation of \
In[202]:=",ExpressionUUID->"7af9e464-1dde-458d-8437-12a9da5006c3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.935659841922791*^9, 
  3.935659907084135*^9}},ExpressionUUID->"62560571-756f-4697-8bfa-\
5f140d93368b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.05`", " ", 
   SubscriptBox["X", "0"], " ", 
   SubscriptBox["X", "1"]}], "+", 
  RowBox[{"0.05`", " ", 
   SubscriptBox["X", "1"], " ", 
   SubscriptBox["X", "2"]}], "+", 
  RowBox[{"0.05`", " ", 
   SubscriptBox["X", "2"], " ", 
   SubscriptBox["X", "3"]}], "+", 
  RowBox[{"0.05`", " ", 
   SubscriptBox["X", "3"], " ", 
   SubscriptBox["X", "4"]}], "+", 
  RowBox[{"0.05`", " ", 
   SubscriptBox["Y", "0"], " ", 
   SubscriptBox["Y", "1"]}], "+", 
  RowBox[{"0.05`", " ", 
   SubscriptBox["Y", "1"], " ", 
   SubscriptBox["Y", "2"]}], "+", 
  RowBox[{"0.05`", " ", 
   SubscriptBox["Y", "2"], " ", 
   SubscriptBox["Y", "3"]}], "+", 
  RowBox[{"0.05`", " ", 
   SubscriptBox["Y", "3"], " ", 
   SubscriptBox["Y", "4"]}], "+", 
  RowBox[{"0.45`", " ", 
   SubscriptBox["Z", "0"]}], "+", 
  RowBox[{"0.05`", " ", 
   SubscriptBox["Z", "1"]}], "+", 
  RowBox[{"1.5`", " ", 
   SubscriptBox["Z", "0"], " ", 
   SubscriptBox["Z", "1"]}], "+", 
  RowBox[{"0.45`", " ", 
   SubscriptBox["Z", "2"]}], "+", 
  RowBox[{"1.`", " ", 
   SubscriptBox["Z", "0"], " ", 
   SubscriptBox["Z", "2"]}], "+", 
  RowBox[{"1.`", " ", 
   SubscriptBox["Z", "1"], " ", 
   SubscriptBox["Z", "2"]}], "+", 
  RowBox[{"0.05`", " ", 
   SubscriptBox["Z", "3"]}], "+", 
  RowBox[{"0.5`", " ", 
   SubscriptBox["Z", "0"], " ", 
   SubscriptBox["Z", "3"]}], "+", 
  RowBox[{"0.5`", " ", 
   SubscriptBox["Z", "1"], " ", 
   SubscriptBox["Z", "3"]}], "+", 
  RowBox[{"0.5`", " ", 
   SubscriptBox["Z", "2"], " ", 
   SubscriptBox["Z", "3"]}], "-", 
  RowBox[{"0.05`", " ", 
   SubscriptBox["Z", "4"]}]}]], "Output",
 CellChangeTimes->{3.935659869338695*^9, 3.935659901538939*^9},
 CellLabel->
  "Out[168]=",ExpressionUUID->"51fa4e78-28fd-46ff-969d-ac539783377e"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"actual e:\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2.879999400813601`"}]}],
  SequenceForm["actual e:", -2.879999400813601],
  Editable->False]], "Print",
 CellChangeTimes->{{3.935659842615781*^9, 3.935659869345866*^9}, 
   3.935659901553331*^9},
 CellLabel->
  "During evaluation of \
In[167]:=",ExpressionUUID->"d2375eb5-7bc1-45b3-88e0-17de99c22d63"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"CoVAR e:\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2.879998704959518`"}]}],
  SequenceForm["CoVAR e:", -2.879998704959518],
  Editable->False]], "Print",
 CellChangeTimes->{{3.935659842615781*^9, 3.935659869345866*^9}, 
   3.935659901553982*^9},
 CellLabel->
  "During evaluation of \
In[167]:=",ExpressionUUID->"79de5cea-c948-45b8-a6ae-a89be8ffa5bf"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 784},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.5 Inherited,
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f7a938fd-093a-4a71-b065-51b183654806"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1087, 25, 295, "Input",ExpressionUUID->"ee69c2b9-9a5d-4159-b2a0-5b5df8704827"],
Cell[1670, 49, 953, 17, 117, "Message",ExpressionUUID->"99640dca-9bf2-483f-aefb-66734efcd19b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2660, 71, 18058, 461, 1789, "Input",ExpressionUUID->"55e6e0fb-26da-4949-814b-41d95cdac340"],
Cell[20721, 534, 176, 4, 36, "Print",ExpressionUUID->"e6fecbe3-34b8-44de-8461-78f9cb42abba"]
}, Open  ]],
Cell[20912, 541, 7597, 214, 636, "Input",ExpressionUUID->"0b4d135e-e348-4875-86e4-355fe52690f2"],
Cell[CellGroupData[{
Cell[28534, 759, 6174, 181, 1039, "Input",ExpressionUUID->"eb1c114d-a4dc-423a-a184-ddc84d5b6b4f"],
Cell[CellGroupData[{
Cell[34733, 944, 352, 8, 36, "Print",ExpressionUUID->"6043e767-f130-47c0-b4ce-7c58eaa4ec57"],
Cell[35088, 954, 391, 9, 36, "Print",ExpressionUUID->"0c01d41a-2362-4356-b914-415d1c6e4d81"],
Cell[35482, 965, 2301, 45, 66, "Print",ExpressionUUID->"80546890-bff9-4e18-a300-f5be9275c403"],
Cell[37786, 1012, 3115, 79, 66, "Print",ExpressionUUID->"64fc2cec-4507-4175-8e60-75fb411f4e73"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40950, 1097, 15201, 333, 2248, "Input",ExpressionUUID->"46f15645-9604-4777-82fe-7414dc24774c"],
Cell[56154, 1432, 458, 10, 41, "Message",ExpressionUUID->"11d550e1-d53c-4b01-b5d4-00b31aa7e31a"],
Cell[56615, 1444, 1305, 22, 104, "Message",ExpressionUUID->"d2b480f9-6e63-47ac-a833-fd8647e9525b"],
Cell[57923, 1468, 1275, 21, 101, "Message",ExpressionUUID->"728fc431-50f2-4985-8ed7-d978d8b1cc40"],
Cell[59201, 1491, 1305, 22, 101, "Message",ExpressionUUID->"cb7661c3-55a3-4f0a-9cec-fcd35a53ec2c"],
Cell[60509, 1515, 477, 10, 41, "Message",ExpressionUUID->"19d86774-89e2-4335-b943-4c768a9f27fa"],
Cell[60989, 1527, 16376, 373, 291, "Output",ExpressionUUID->"a15cd53c-08f1-47a6-9323-0b1003915cd5"],
Cell[CellGroupData[{
Cell[77390, 1904, 377, 9, 36, "Print",ExpressionUUID->"273552e8-6123-47f4-b62c-3d378dd4cc18"],
Cell[77770, 1915, 378, 9, 36, "Print",ExpressionUUID->"7af9e464-1dde-458d-8437-12a9da5006c3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[78197, 1930, 152, 3, 46, "Input",ExpressionUUID->"62560571-756f-4697-8bfa-5f140d93368b"],
Cell[78352, 1935, 1771, 56, 84, "Output",ExpressionUUID->"51fa4e78-28fd-46ff-969d-ac539783377e"],
Cell[CellGroupData[{
Cell[80148, 1995, 405, 10, 36, "Print",ExpressionUUID->"d2375eb5-7bc1-45b3-88e0-17de99c22d63"],
Cell[80556, 2007, 403, 10, 36, "Print",ExpressionUUID->"79de5cea-c948-45b8-a6ae-a89be8ffa5bf"]
}, Open  ]]
}, Open  ]]
}
]
*)

