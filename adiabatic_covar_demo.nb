(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     55627,       1441]
NotebookOptionsPosition[     54148,       1408]
NotebookOutlinePosition[     54574,       1425]
CellTagsIndexPosition[     54531,       1422]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Import", "[", "\"\<https://qtechtheory.org/questlink.m\>\"", 
  "]"}], "\n", 
 RowBox[{
  RowBox[{"CreateDownloadedQuESTEnv", "[", "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.932022288700487*^9, 3.9320223611923027`*^9}},
 CellLabel->
  "In[1857]:=",ExpressionUUID->"ee69c2b9-9a5d-4159-b2a0-5b5df8704827"],

Cell[BoxData[
 TemplateBox[{
  "QuESTlink", "notice", 
   "\"Bug alert! Prior to this version (v0.19), SimplifyPaulis[] contained a \
bug whereby multiplying X and Z operators (targeting the same qubit) produced \
a Y operator with an incorrect sign. This bug occurred only when multiplying \
Pauli strings together, and did not affect other algebraic forms (like \
summing or exponentiation), though did affect the downstream function \
CalcPauliExpressionMatrix[]. Please check any previous calculations which \
passed products of Pauli-strings to SimplifyPaulis[] and \
CalcPauliExpressionMatrix[]. We sincerely apologise for any arising issues! \
Silence this warning using Quiet[].\"", 2, 1857, 368, 18403791784009654925, 
   "Local", "QuEST`Private`QuESTlink"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{{3.9320222924292307`*^9, 3.932022362687791*^9}, 
   3.9326295120130444`*^9},
 CellLabel->
  "During evaluation of \
In[1857]:=",ExpressionUUID->"c37eb675-49f0-4351-9175-4ac0c38079a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"my\[Theta]", "[", "num_", "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Theta]", ",", "num"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"generateAnsatzCircuit", "[", 
    RowBox[{"circuitN_", ",", "nblock_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ansatz", ",", "c", ",", "blocks", ",", "paramCount"}], "}"}], 
     ",", 
     RowBox[{
      RowBox[{"ansatz", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ansatz", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ansatz", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"Rx", ",", "qb"}], "]"}], "[", 
            RowBox[{"my\[Theta]", "[", 
             RowBox[{"c", "++"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"qb", ",", "0", ",", 
             RowBox[{"circuitN", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ansatz", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ansatz", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"Rz", ",", "qb"}], "]"}], "[", 
            RowBox[{"my\[Theta]", "[", 
             RowBox[{"c", "++"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"qb", ",", "0", ",", 
             RowBox[{"circuitN", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ansatz", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ansatz", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"Ry", ",", "qb"}], "]"}], "[", 
            RowBox[{"my\[Theta]", "[", 
             RowBox[{"c", "++"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"qb", ",", "0", ",", 
             RowBox[{"circuitN", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"blocks", "=", "1"}], ",", 
        RowBox[{"blocks", "<=", "nblock"}], ",", 
        RowBox[{"blocks", "++"}], ",", 
        RowBox[{
         RowBox[{"ansatz", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"ansatz", ",", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"R", "[", 
                 RowBox[{
                  RowBox[{"my\[Theta]", "[", 
                   RowBox[{"c", "++"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{"Z", ",", "qb"}], "]"}], "  ", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"Z", ",", 
                    RowBox[{"qb", "+", "1"}]}], "]"}]}]}], "]"}], "}"}], ",", 
               
               RowBox[{"{", 
                RowBox[{"qb", ",", "0", ",", 
                 RowBox[{"circuitN", "-", "2"}]}], "}"}]}], "]"}]}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ansatz", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"ansatz", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"Rx", ",", "qb"}], "]"}], "[", 
               RowBox[{"my\[Theta]", "[", 
                RowBox[{"c", "++"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"qb", ",", "0", ",", 
                RowBox[{"circuitN", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"ansatz", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"ansatz", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"Ry", ",", "qb"}], "]"}], "[", 
               RowBox[{"my\[Theta]", "[", 
                RowBox[{"c", "++"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"qb", ",", "0", ",", 
                RowBox[{"circuitN", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
         ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"paramCount", "=", 
       RowBox[{"c", "-", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "@", 
       RowBox[{"{", 
        RowBox[{"ansatz", ",", "paramCount"}], "}"}]}], ";"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"pauli", "[", 
    RowBox[{"type_", ",", "site_"}], "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"type", ",", "site"}], "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getListOf3LocalPaulis", "[", "numQs_", "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pauli", "[", 
            RowBox[{"type", ",", "site"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"site", ",", "0", ",", 
            RowBox[{"numQs", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"type", ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], "}"}]}], "]"}], ",", 
        "1"}], "]"}], ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"pauli", "[", 
             RowBox[{"type1", ",", "site1"}], "]"}], ",", 
            RowBox[{"pauli", "[", 
             RowBox[{"type2", ",", "site2"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"site1", ",", "0", ",", 
            RowBox[{"numQs", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"site2", ",", 
            RowBox[{"site1", "+", "1"}], ",", 
            RowBox[{"numQs", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"type1", ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"type2", ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], "}"}]}], "]"}], ",", 
        "3"}], "]"}], ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"pauli", "[", 
             RowBox[{"type1", ",", "site1"}], "]"}], ",", 
            RowBox[{"pauli", "[", 
             RowBox[{"type2", ",", "site2"}], "]"}], ",", 
            RowBox[{"pauli", "[", 
             RowBox[{"type3", ",", "site3"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"site1", ",", "0", ",", 
            RowBox[{"numQs", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"site2", ",", 
            RowBox[{"site1", "+", "1"}], ",", 
            RowBox[{"numQs", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"site3", ",", 
            RowBox[{"site2", "+", "1"}], ",", 
            RowBox[{"numQs", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"type1", ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"type2", ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"type3", ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], "}"}]}], "]"}], ",", 
        "5"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"localpaulis", "=", 
   RowBox[{"getListOf3LocalPaulis", "[", "numQs", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nCONS", "=", 
   RowBox[{"Length", "@", "localpaulis"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "@", 
   RowBox[{"Length", "@", "localpaulis"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"computeFvector", "[", 
    RowBox[{
    "\[Psi]_", ",", "\[Psi]s_", ",", "h\[Psi]_", ",", "hamil_", ",", 
     "operatorPool_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"term2s", ",", "term3", ",", "vec"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ApplyCircuit", "[", 
          RowBox[{"\[Psi]", ",", 
           RowBox[{"operatorPool", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", 
           RowBox[{"\[Psi]s", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "@", "operatorPool"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ApplyPauliString", "[", 
       RowBox[{"\[Psi]", ",", "hamil", ",", "h\[Psi]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"term2s", "=", 
       RowBox[{"CalcInnerProducts", "[", 
        RowBox[{"\[Psi]", ",", "\[Psi]s"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"term3", "=", 
       RowBox[{"CalcInnerProduct", "[", 
        RowBox[{"\[Psi]", ",", "h\[Psi]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vec", "=", 
       RowBox[{
        RowBox[{"Conjugate", "@", 
         RowBox[{"CalcInnerProducts", "[", 
          RowBox[{"h\[Psi]", ",", "\[Psi]s"}], "]"}]}], "-", 
        RowBox[{"term2s", "*", "term3"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Re", "@", "vec"}], ",", 
         RowBox[{"Im", "@", "vec"}]}], "]"}], "]"}], ";"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"computeJacobian", "[", 
    RowBox[{
    "\[Psi]_", ",", "\[Psi]s_", ",", "h\[Psi]_", ",", "d\[Psi]_", ",", 
     "hamil_", ",", "operatorPool_", ",", "ansatz_", ",", "params_"}], "]"}], 
   ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "term1", ",", "term2", ",", "term3", ",", "term3a", ",", "term3b", ",", 
       "en"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"ApplyCircuitDerivs", "[", 
        RowBox[{
         RowBox[{"InitZeroState", "[", "\[Psi]", "]"}], ",", "ansatz", ",", 
         "params", ",", "d\[Psi]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ApplyCircuit", "[", 
        RowBox[{
         RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
         RowBox[{"ansatz", "/.", " ", "params"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ApplyPauliString", "[", 
        RowBox[{"\[Psi]", ",", "hamil", ",", "h\[Psi]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ApplyCircuit", "[", 
           RowBox[{"h\[Psi]", ",", 
            RowBox[{"operatorPool", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", 
            RowBox[{"\[Psi]s", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "@", "operatorPool"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"term1a", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"CalcInnerProducts", "[", 
           RowBox[{
            RowBox[{"d\[Psi]", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", "\[Psi]s"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"Length", "@", "d\[Psi]"}]}], "}"}]}], "]"}]}], "    ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"<", "d\[Psi]_k"}], "|", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"O", ",", "k"}], "]"}], " ", "H", " ", "\[Psi]"}], 
          ">"}]}], "*)"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ApplyCircuit", "[", 
           RowBox[{"\[Psi]", ",", 
            RowBox[{"operatorPool", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", "h\[Psi]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ApplyPauliString", "[", 
           RowBox[{"h\[Psi]", ",", "hamil", ",", 
            RowBox[{"\[Psi]s", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "@", "operatorPool"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"<", "\[Psi]"}], "|", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"O", ",", "k"}], "]"}], " ", "H"}], "|", 
         RowBox[{"d\[Psi]_k", ">"}]}], "*)"}], 
       RowBox[{"term1b", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Conjugate", "@", 
           RowBox[{"CalcInnerProducts", "[", 
            RowBox[{
             RowBox[{"d\[Psi]", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "\[Psi]s"}], "]"}]}], ",", 
          
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"Length", "@", "d\[Psi]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"term1", "=", 
        RowBox[{"(", 
         RowBox[{"term1a", "+", "term1b"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ApplyCircuit", "[", 
           RowBox[{"\[Psi]", ",", 
            RowBox[{"operatorPool", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", 
            RowBox[{"\[Psi]s", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "@", "operatorPool"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ApplyPauliString", "[", 
        RowBox[{"\[Psi]", ",", "hamil", ",", "h\[Psi]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"en", "=", 
        RowBox[{"CalcInnerProduct", "[", 
         RowBox[{"\[Psi]", ",", "h\[Psi]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "Re"}], "<", "\[Psi]"}], "|", 
         RowBox[{
          RowBox[{"H", " ", "\[Psi]"}], ">"}]}], "*)"}], 
       RowBox[{"term2", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"2", "  ", 
            RowBox[{"Re", "@", 
             RowBox[{"CalcInnerProducts", "[", 
              RowBox[{
               RowBox[{"d\[Psi]", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", "\[Psi]s"}], "]"}]}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "@", "d\[Psi]"}]}], "}"}]}], "]"}], "*", 
         "en"}]}], "    ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "Re"}], "<", "d\[Psi]_k"}], "|", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"H", ",", "a"}], "]"}], " ", "\[Psi]"}], ">"}]}], "*)"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"term3a", "=", 
        RowBox[{"CalcInnerProducts", "[", 
         RowBox[{"\[Psi]", ",", "\[Psi]s"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "Re"}], "<", "\[Psi]"}], "|", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"H", ",", "a"}], "]"}], " ", "\[Psi]"}], ">"}]}], "*)"}], 
       
       RowBox[{"term3b", "=", 
        RowBox[{"2", "  ", 
         RowBox[{"Re", "[", 
          RowBox[{"CalcInnerProducts", "[", 
           RowBox[{"h\[Psi]", ",", "d\[Psi]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"energyGradient", "=", "term3b"}], ";"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"2", "Re"}], "<", "d\[Psi]_k"}], "|", 
        RowBox[{
         RowBox[{"H", " ", "\[Psi]"}], ">"}]}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"term3", "=", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"term3b", ",", "term3a"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"jacobian", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"term1", "-", "term2", "-", "term3"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Re", "@", "jacobian"}], ",", 
         RowBox[{"Im", "@", "jacobian"}]}], "]"}], "]"}], ";"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{3.932630209975585*^9},
 CellLabel->
  "In[1859]:=",ExpressionUUID->"55e6e0fb-26da-4949-814b-41d95cdac340"],

Cell[BoxData["3675"], "Print",
 CellChangeTimes->{3.9326302170363293`*^9},
 CellLabel->
  "During evaluation of \
In[1859]:=",ExpressionUUID->"934f4a0f-8201-48c5-bb79-8b732a6b8ccd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Key", " ", "Variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NumQs", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"deltaT", " ", "=", " ", "0.15"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"start", "=", 
     RowBox[{"Mod", "[", 
      RowBox[{"1.0", ",", "deltaT"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Sample", " ", "spin", " ", "chain", " ", "Hamiltonian"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hamil", " ", "=", " ", 
     RowBox[{
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "0"], " ", 
       SubscriptBox["X", "1"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "0"], " ", 
       SubscriptBox["X", "2"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "1"], " ", 
       SubscriptBox["X", "2"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "0"], " ", 
       SubscriptBox["X", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "1"], " ", 
       SubscriptBox["X", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "2"], " ", 
       SubscriptBox["X", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "0"], " ", 
       SubscriptBox["X", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "1"], " ", 
       SubscriptBox["X", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "2"], " ", 
       SubscriptBox["X", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["X", "3"], " ", 
       SubscriptBox["X", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "0"], " ", 
       SubscriptBox["Y", "1"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "0"], " ", 
       SubscriptBox["Y", "2"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "1"], " ", 
       SubscriptBox["Y", "2"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "0"], " ", 
       SubscriptBox["Y", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "1"], " ", 
       SubscriptBox["Y", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "2"], " ", 
       SubscriptBox["Y", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "0"], " ", 
       SubscriptBox["Y", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "1"], " ", 
       SubscriptBox["Y", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "2"], " ", 
       SubscriptBox["Y", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Y", "3"], " ", 
       SubscriptBox["Y", "4"]}], "-", 
      RowBox[{"0.5`", " ", 
       SubscriptBox["Z", "0"]}], "+", 
      RowBox[{"0.3`", " ", 
       SubscriptBox["Z", "1"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "0"], " ", 
       SubscriptBox["Z", "1"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "2"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "0"], " ", 
       SubscriptBox["Z", "2"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "1"], " ", 
       SubscriptBox["Z", "2"]}], "-", 
      RowBox[{"0.7`", " ", 
       SubscriptBox["Z", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "0"], " ", 
       SubscriptBox["Z", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "1"], " ", 
       SubscriptBox["Z", "3"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "2"], " ", 
       SubscriptBox["Z", "3"]}], "+", 
      RowBox[{"0.2`", " ", 
       SubscriptBox["Z", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "0"], " ", 
       SubscriptBox["Z", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "1"], " ", 
       SubscriptBox["Z", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "2"], " ", 
       SubscriptBox["Z", "4"]}], "+", 
      RowBox[{"0.1`", " ", 
       SubscriptBox["Z", "3"], " ", 
       SubscriptBox["Z", "4"]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hamilO", "[", 
      RowBox[{"numQs_", ",", " ", "t_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "hamil", "}"}], ",", 
       RowBox[{
        RowBox[{"hamil", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "t"}], ")"}], "*", 
            RowBox[{"Subscript", "[", 
             RowBox[{"X", ",", 
              RowBox[{"k", "-", "1"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "numQs"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "@", "hamil"}], ";"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeHamil", "[", 
      RowBox[{"Hamil_", ",", " ", "t_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "hamil", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"hamil", "=", 
         RowBox[{"hamilO", "[", 
          RowBox[{"numQs", ",", " ", "t"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hamil", "+=", 
         RowBox[{"t", "*", "Hamil"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "@", "hamil"}], ";"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.932630628173092*^9, 3.93263062992837*^9}, 
   3.932630895911252*^9, {3.932631017192005*^9, 
   3.932631164659758*^9}},ExpressionUUID->"0b4d135e-e348-4875-86e4-\
355fe52690f2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ansatz", ",", "numParams"}], "}"}], "=", 
   RowBox[{"generateAnsatzCircuit", "[", 
    RowBox[{"numQs", ",", "layers"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<number of parameters:\>\"", ",", " ", "numParams"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"CreateQureg", "[", "numQs", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h\[Psi]", "=", 
   RowBox[{"CreateQureg", "[", "numQs", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Psi]", "=", 
   RowBox[{"CreateQuregs", "[", 
    RowBox[{"numQs", ",", "numParams"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]s", "=", 
    RowBox[{"CreateQuregs", "[", 
     RowBox[{"numQs", ",", "nCONS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"MORPHING", " ", "PARAM"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{"\[Theta]", ",", "k"}], "]"}], "->", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "numQs"}], "+", "1"}], "<=", "k", "<=", " ", 
          RowBox[{"3", "*", "numQs"}]}], " ", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"k", "==", "12"}], "||", 
            RowBox[{"k", "==", "11"}]}], ",", "0", ",", 
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}], ",", "0"}], "]"}]}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "numParams"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Theta]", ",", "k"}], "]"}], "->", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"2", "*", "numQs"}], "+", "1"}], "<=", "k", "<=", " ", 
           RowBox[{"3", "*", "numQs"}]}], " ", ",", "\[Pi]", ",", "0"}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "numParams"}], "}"}]}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"randomStep", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Theta]", ",", "k"}], "]"}], "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "500"}], ",", 
         RowBox[{"\[Pi]", "/", "500"}]}], "}"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "numParams"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"params", "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", "2"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"params", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "2"}], "]"}], "]"}], "+", 
     RowBox[{"randomStep", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"CreateQureg", "[", "numQs", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplyCircuit", "[", 
   RowBox[{
    RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
    RowBox[{"ansatz", "/.", " ", "params"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"params", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hamil", " ", "=", " ", 
   RowBox[{"ExpandAll", "@", 
    RowBox[{"Chop", "@", 
     RowBox[{"timeHamil", "[", 
      RowBox[{"Hamil", ",", " ", "0"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hamilmat", "=", 
   RowBox[{"CalcPauliStringMatrix", "[", "hamil", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"realEnergy", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Eigenvalues", "@", "hamilmat"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eigenvec", " ", "=", " ", 
    RowBox[{"Eigenvectors", "@", "hamilmat"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalIter", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ansatz", "/.", " ", "params"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetQuregMatrix", "[", "\[Psi]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplyPauliString", "[", 
   RowBox[{"\[Psi]", ",", "hamil", ",", "h\[Psi]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"Chop", "@", 
    RowBox[{"CalcInnerProduct", "[", 
     RowBox[{"h\[Psi]", ",", "\[Psi]"}], "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<energy computed:\>\"", ",", " ", "energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<actual E:\>\"", ",", " ", "realEnergy"}], "]"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalHamil", " ", "=", " ", 
   RowBox[{"ExpandAll", "@", 
    RowBox[{"Chop", "@", 
     RowBox[{"timeHamil", "[", 
      RowBox[{"Hamil", ",", " ", "1.0"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Final hamil:\>\"", ",", " ", "finalHamil"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9326311812207623`*^9, 3.9326312812124577`*^9}, 
   3.932631320091906*^9},
 CellLabel->
  "In[2044]:=",ExpressionUUID->"eb1c114d-a4dc-423a-a184-ddc84d5b6b4f"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"number of parameters:\"\>", "\[InvisibleSpace]", "57"}],
  SequenceForm["number of parameters:", 57],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9326312095316067`*^9, {3.9326312476483793`*^9, 3.9326312849942493`*^9}, 
   3.932631321518468*^9},
 CellLabel->
  "During evaluation of \
In[2044]:=",ExpressionUUID->"0127df2f-fcd3-4879-9e57-4c77880561c1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"energy computed:\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2.9904187875510124`"}]}],
  SequenceForm["energy computed:", -2.9904187875510124`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9326312095316067`*^9, {3.9326312476483793`*^9, 3.9326312849942493`*^9}, 
   3.9326313215774393`*^9},
 CellLabel->
  "During evaluation of \
In[2044]:=",ExpressionUUID->"b7b6b806-a766-4db8-864d-e55f38ffa7f7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"actual E:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.9999999999999964`"}], ",", 
     RowBox[{"-", "3.000000000000002`"}], ",", 
     RowBox[{"-", "3.0000000000000013`"}], ",", 
     RowBox[{"-", "3.0000000000000004`"}], ",", 
     RowBox[{"-", "2.9999999999999996`"}], ",", 
     RowBox[{"-", "2.9999999999999973`"}], ",", 
     RowBox[{"-", "1.0000000000000016`"}], ",", 
     RowBox[{"-", "1.0000000000000002`"}], ",", 
     RowBox[{"-", "1.`"}], ",", 
     RowBox[{"-", "0.9999999999999999`"}], ",", 
     RowBox[{"-", "0.9999999999999999`"}], ",", 
     RowBox[{"-", "0.9999999999999998`"}], ",", 
     RowBox[{"-", "0.9999999999999993`"}], ",", 
     RowBox[{"-", "0.999999999999999`"}], ",", 
     RowBox[{"-", "0.999999999999998`"}], ",", 
     RowBox[{"-", "0.9999999999999979`"}], ",", "0.9999999999999972`", ",", 
     "0.9999999999999991`", ",", "0.9999999999999996`", ",", 
     "0.9999999999999996`", ",", "0.9999999999999996`", ",", 
     "1.0000000000000002`", ",", "1.0000000000000002`", ",", 
     "1.0000000000000007`", ",", "1.0000000000000007`", ",", 
     "1.0000000000000013`", ",", "2.9999999999999973`", ",", 
     "2.9999999999999982`", ",", "2.9999999999999996`", ",", 
     "3.0000000000000013`", ",", "3.0000000000000018`", ",", 
     "4.9999999999999964`"}], "}"}]}],
  SequenceForm[
  "actual E:", {-4.9999999999999964`, -3.000000000000002, \
-3.0000000000000013`, -3.0000000000000004`, -2.9999999999999996`, \
-2.9999999999999973`, -1.0000000000000016`, -1.0000000000000002`, -1., \
-0.9999999999999999, -0.9999999999999999, -0.9999999999999998, \
-0.9999999999999993, -0.999999999999999, -0.999999999999998, \
-0.9999999999999979, 0.9999999999999972, 0.9999999999999991, 
   0.9999999999999996, 0.9999999999999996, 0.9999999999999996, 
   1.0000000000000002`, 1.0000000000000002`, 1.0000000000000007`, 
   1.0000000000000007`, 1.0000000000000013`, 2.9999999999999973`, 
   2.9999999999999982`, 2.9999999999999996`, 3.0000000000000013`, 
   3.0000000000000018`, 4.9999999999999964`}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9326312095316067`*^9, {3.9326312476483793`*^9, 3.9326312849942493`*^9}, 
   3.932631321578106*^9},
 CellLabel->
  "During evaluation of \
In[2044]:=",ExpressionUUID->"7f93001d-1509-487c-ae6a-34e20de75979"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final hamil:\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"0.1`", " ", 
     SubscriptBox["X", "0"], " ", 
     SubscriptBox["X", "1"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["X", "0"], " ", 
     SubscriptBox["X", "2"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["X", "1"], " ", 
     SubscriptBox["X", "2"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["X", "0"], " ", 
     SubscriptBox["X", "3"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["X", "1"], " ", 
     SubscriptBox["X", "3"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["X", "2"], " ", 
     SubscriptBox["X", "3"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["X", "0"], " ", 
     SubscriptBox["X", "4"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["X", "1"], " ", 
     SubscriptBox["X", "4"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["X", "2"], " ", 
     SubscriptBox["X", "4"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["X", "3"], " ", 
     SubscriptBox["X", "4"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Y", "0"], " ", 
     SubscriptBox["Y", "1"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Y", "0"], " ", 
     SubscriptBox["Y", "2"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Y", "1"], " ", 
     SubscriptBox["Y", "2"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Y", "0"], " ", 
     SubscriptBox["Y", "3"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Y", "1"], " ", 
     SubscriptBox["Y", "3"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Y", "2"], " ", 
     SubscriptBox["Y", "3"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Y", "0"], " ", 
     SubscriptBox["Y", "4"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Y", "1"], " ", 
     SubscriptBox["Y", "4"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Y", "2"], " ", 
     SubscriptBox["Y", "4"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Y", "3"], " ", 
     SubscriptBox["Y", "4"]}], "-", 
    RowBox[{"0.5`", " ", 
     SubscriptBox["Z", "0"]}], "+", 
    RowBox[{"0.3`", " ", 
     SubscriptBox["Z", "1"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Z", "0"], " ", 
     SubscriptBox["Z", "1"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Z", "2"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Z", "0"], " ", 
     SubscriptBox["Z", "2"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Z", "1"], " ", 
     SubscriptBox["Z", "2"]}], "-", 
    RowBox[{"0.7`", " ", 
     SubscriptBox["Z", "3"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Z", "0"], " ", 
     SubscriptBox["Z", "3"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Z", "1"], " ", 
     SubscriptBox["Z", "3"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Z", "2"], " ", 
     SubscriptBox["Z", "3"]}], "+", 
    RowBox[{"0.2`", " ", 
     SubscriptBox["Z", "4"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Z", "0"], " ", 
     SubscriptBox["Z", "4"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Z", "1"], " ", 
     SubscriptBox["Z", "4"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Z", "2"], " ", 
     SubscriptBox["Z", "4"]}], "+", 
    RowBox[{"0.1`", " ", 
     SubscriptBox["Z", "3"], " ", 
     SubscriptBox["Z", "4"]}]}]}],
  SequenceForm[
  "Final hamil:", 0.1 Subscript[QuEST`Gate`X, 0] Subscript[QuEST`Gate`X, 1] + 
   0.1 Subscript[QuEST`Gate`X, 0] Subscript[QuEST`Gate`X, 2] + 
   0.1 Subscript[QuEST`Gate`X, 1] Subscript[QuEST`Gate`X, 2] + 
   0.1 Subscript[QuEST`Gate`X, 0] Subscript[QuEST`Gate`X, 3] + 
   0.1 Subscript[QuEST`Gate`X, 1] Subscript[QuEST`Gate`X, 3] + 
   0.1 Subscript[QuEST`Gate`X, 2] Subscript[QuEST`Gate`X, 3] + 
   0.1 Subscript[QuEST`Gate`X, 0] Subscript[QuEST`Gate`X, 4] + 
   0.1 Subscript[QuEST`Gate`X, 1] Subscript[QuEST`Gate`X, 4] + 
   0.1 Subscript[QuEST`Gate`X, 2] Subscript[QuEST`Gate`X, 4] + 
   0.1 Subscript[QuEST`Gate`X, 3] Subscript[QuEST`Gate`X, 4] + 
   0.1 Subscript[QuEST`Gate`Y, 0] Subscript[QuEST`Gate`Y, 1] + 
   0.1 Subscript[QuEST`Gate`Y, 0] Subscript[QuEST`Gate`Y, 2] + 
   0.1 Subscript[QuEST`Gate`Y, 1] Subscript[QuEST`Gate`Y, 2] + 
   0.1 Subscript[QuEST`Gate`Y, 0] Subscript[QuEST`Gate`Y, 3] + 
   0.1 Subscript[QuEST`Gate`Y, 1] Subscript[QuEST`Gate`Y, 3] + 
   0.1 Subscript[QuEST`Gate`Y, 2] Subscript[QuEST`Gate`Y, 3] + 
   0.1 Subscript[QuEST`Gate`Y, 0] Subscript[QuEST`Gate`Y, 4] + 
   0.1 Subscript[QuEST`Gate`Y, 1] Subscript[QuEST`Gate`Y, 4] + 
   0.1 Subscript[QuEST`Gate`Y, 2] Subscript[QuEST`Gate`Y, 4] + 
   0.1 Subscript[QuEST`Gate`Y, 3] Subscript[QuEST`Gate`Y, 4] - 0.5 
   Subscript[QuEST`Gate`Z, 0] + 0.3 Subscript[QuEST`Gate`Z, 1] + 
   0.1 Subscript[QuEST`Gate`Z, 0] Subscript[QuEST`Gate`Z, 1] + 
   0.1 Subscript[QuEST`Gate`Z, 2] + 
   0.1 Subscript[QuEST`Gate`Z, 0] Subscript[QuEST`Gate`Z, 2] + 
   0.1 Subscript[QuEST`Gate`Z, 1] Subscript[QuEST`Gate`Z, 2] - 0.7 
   Subscript[QuEST`Gate`Z, 3] + 
   0.1 Subscript[QuEST`Gate`Z, 0] Subscript[QuEST`Gate`Z, 3] + 
   0.1 Subscript[QuEST`Gate`Z, 1] Subscript[QuEST`Gate`Z, 3] + 
   0.1 Subscript[QuEST`Gate`Z, 2] Subscript[QuEST`Gate`Z, 3] + 
   0.2 Subscript[QuEST`Gate`Z, 4] + 
   0.1 Subscript[QuEST`Gate`Z, 0] Subscript[QuEST`Gate`Z, 4] + 
   0.1 Subscript[QuEST`Gate`Z, 1] Subscript[QuEST`Gate`Z, 4] + 
   0.1 Subscript[QuEST`Gate`Z, 2] Subscript[QuEST`Gate`Z, 4] + 
   0.1 Subscript[QuEST`Gate`Z, 3] Subscript[QuEST`Gate`Z, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9326312095316067`*^9, {3.9326312476483793`*^9, 3.9326312849942493`*^9}, 
   3.932631321583548*^9},
 CellLabel->
  "During evaluation of \
In[2044]:=",ExpressionUUID->"a27d4ca0-55cb-488e-af2a-afba2c3a4473"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"paramsList", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"realEnergyList", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covarEnergy", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", "t", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"t", "==", "1.0"}], ",", 
          RowBox[{"iter", "=", "100"}], ",", 
          RowBox[{"iter", "=", "50"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "iter", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"hamil", " ", "=", " ", 
         RowBox[{"ExpandAll", "@", 
          RowBox[{"Chop", "@", 
           RowBox[{"timeHamil", "[", 
            RowBox[{"Hamil", ",", " ", "t"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{"(*", 
          RowBox[{"Usually", ",", 
           RowBox[{
           "you", " ", "would", " ", "sample", " ", "from", " ", "the", " ", 
            "operator", " ", "pool"}], ",", 
           RowBox[{
           "but", " ", "for", " ", "5", " ", "qubits", " ", "it", " ", "is", 
            " ", "small", " ", "enough", " ", "that", " ", "we", " ", "can", 
            " ", "use", " ", "all", " ", "of", " ", "it"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"operatorPool", "=", 
               RowBox[{"RandomSample", "[", 
                RowBox[{"localpaulis", ",", " ", "nCONS"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"vec", "=", 
               RowBox[{"computeFvector", "[", 
                RowBox[{
                "\[Psi]", ",", "\[Psi]s", ",", "h\[Psi]", ",", "hamil", ",", 
                 " ", "operatorPool"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"jacobian", "=", 
               RowBox[{"computeJacobian", "[", 
                RowBox[{
                "\[Psi]", ",", " ", "\[Psi]s", ",", "h\[Psi]", ",", "d\[Psi]",
                  ",", "hamil", ",", "operatorPool", ",", "ansatz", ",", 
                 "params"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"vecDim", " ", "=", " ", 
               RowBox[{"Dimensions", "[", "vec", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"jacDim", " ", "=", " ", 
               RowBox[{"Dimensions", "[", "jacobian", "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", " ", "shot", " ", "noise", " ", "simulation"}],
                 ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"add", "\[IndentingNewLine]", "vec"}], " ", "=", 
                  " ", 
                  RowBox[{"vec", " ", "+", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"1", "/", 
                    RowBox[{"10", "^", "3"}]}]}], "]"}], ",", " ", "vecDim"}],
                     "]"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"jacobian", " ", "=", " ", 
                  RowBox[{"jacobian", " ", "+", " ", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"1", "/", 
                    RowBox[{"10", "^", "3"}]}]}], "]"}], ",", " ", "jacDim"}],
                     "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"myVecNorms", ",", 
                RowBox[{
                 RowBox[{"Norm", "[", "vec", "]"}], "^", "2"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"myVecNorms", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], " ", "==", " ", 
                 RowBox[{"myVecNorms", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "2"}], "]"}], "]"}]}], ",", " ", 
                RowBox[{
                 RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "Calculate", " ", "step", " ", "from", " ", "jacobian", " ", 
                "and", " ", "F", " ", "vector", " ", "with", " ", 
                "regularisation"}], "*)"}], " ", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"eta", "=", 
                  RowBox[{"0.0001", "*", 
                   RowBox[{"2", "^", "etaIT"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"jtj", "=", 
                  RowBox[{
                   RowBox[{"Transpose", "[", "jacobian", "]"}], ".", 
                   "jacobian"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"stepvec", "=", 
                  RowBox[{
                   RowBox[{"-", "0.5"}], 
                   RowBox[{
                    RowBox[{"Inverse", "[", 
                    RowBox[{"jtj", "+", 
                    RowBox[{"eta", "*", 
                    RowBox[{"DiagonalMatrix", "@", 
                    RowBox[{"Diagonal", "@", "jtj"}]}]}]}], "]"}], ".", 
                    RowBox[{"Transpose", "[", "jacobian", "]"}], ".", 
                    "vec"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Max", "@", 
                    RowBox[{"Abs", "@", "stepvec"}]}], ">", "1"}], ",", 
                   RowBox[{"stepvec", "=", 
                    RowBox[{"stepvec", "/", 
                    RowBox[{"Max", "@", 
                    RowBox[{"Abs", "@", "stepvec"}]}]}]}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"paramsTST", "=", "params"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"paramsTST", "[", 
                   RowBox[{"[", 
                    RowBox[{";;", ",", "2"}], "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"paramsTST", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "2"}], "]"}], "]"}], "+", 
                   "stepvec"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"ApplyCircuit", "[", 
                  RowBox[{
                   RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
                   RowBox[{"ansatz", "/.", "paramsTST"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"newNORM", "=", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"computeFvector", "[", 
                    RowBox[{
                    "\[Psi]", ",", "\[Psi]s", ",", "h\[Psi]", ",", "hamil", 
                    ",", " ", "operatorPool"}], "]"}], "]"}], "^", "2"}]}], 
                 ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"newNORM", "<", 
                    RowBox[{"myVecNorms", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"Break", "[", "]"}], ";"}]}], "]"}]}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"etaIT", ",", "0", ",", "10"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Update", " ", "parameters"}], "*)"}], 
              RowBox[{
               RowBox[{"params", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "2"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"params", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "2"}], "]"}], "]"}], "+", "stepvec"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"ansatz", "/.", " ", "params"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"ApplyCircuit", "[", 
               RowBox[{
                RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
                RowBox[{"ansatz", "/.", "params"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"energy", " ", "=", " ", 
               RowBox[{"CalcExpecPauliString", "[", 
                RowBox[{"\[Psi]", ",", " ", "hamil", ",", " ", "h\[Psi]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"count", "=", 
               RowBox[{"count", "+", "1"}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"paramsList", ",", "params"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"realEnergyList", ",", " ", "energy"}], "]"}], ";"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"step", ",", "1", ",", "iter"}], "}"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"ListLinePlot", "[", 
             RowBox[{"realEnergyList", ",", " ", 
              RowBox[{"ImageSize", "\[Rule]", "300"}], ",", " ", 
              RowBox[{"AxesLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<Iteration\>\"", ",", "\"\<Energy\>\""}], 
                "}"}]}]}], "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"realEnergy", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"Eigenvalues", "@", 
           RowBox[{"CalcPauliStringMatrix", "[", "hamil", "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ansatz", "/.", " ", "params"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ApplyCircuit", "[", 
         RowBox[{
          RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
          RowBox[{"ansatz", "/.", "params"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"energy", " ", "=", " ", 
         RowBox[{"CalcExpecPauliString", "[", 
          RowBox[{"\[Psi]", ",", " ", "hamil", ",", " ", "h\[Psi]"}], "]"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"covarEnergy", ",", "energy"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"actualEnergyList", ",", " ", "realEnergy"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"totalIter", " ", "=", " ", 
         RowBox[{"totalIter", " ", "+", "1"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "start", ",", "1", ",", "deltaT"}], "}"}]}], "]"}], 
     ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{"covarEnergy", ",", " ", 
        RowBox[{"ImageSize", "\[Rule]", "300"}], ",", " ", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Time\>\"", ",", "\"\<Energy\>\""}], "}"}]}]}], "]"}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "count", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"countList", ",", "count"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Row", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"realEnergyList", ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", "300"}], ",", " ", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Iteration\>\"", ",", "\"\<Energy\>\""}], "}"}]}]}], 
      "]"}], ",", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"covarEnergy", ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", "300"}], ",", " ", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<time\>\"", ",", "\"\<Energy\>\""}], "}"}]}]}], "]"}]}], 
    "}"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Final", " ", "comparison"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hamil", " ", "=", " ", 
   RowBox[{"ExpandAll", "@", 
    RowBox[{"Chop", "@", 
     RowBox[{"Hamil", "[", 
      RowBox[{
      "1.0", ",", "0.1", ",", " ", "0", ",", "0.1", ",", "5", ",", "1.0"}], 
      "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hamilmat", "=", 
   RowBox[{"CalcPauliStringMatrix", "[", "hamil", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"realEnergy", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Eigenvalues", "@", "hamilmat"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<actual e:\>\"", ",", " ", "realEnergy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<CoVAR e:\>\"", ",", " ", "energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.932631303939684*^9, 3.9326314712827253`*^9}, {
  3.93263151486057*^9, 3.932631529564864*^9}, {3.932631562713439*^9, 
  3.9326315676212673`*^9}, {3.932631601966617*^9, 
  3.932631721754529*^9}},ExpressionUUID->"46f15645-9604-4777-82fe-\
7414dc24774c"]
},
WindowSize->{808, 685},
WindowMargins->{{771, Automatic}, {Automatic, -407}},
Magnification:>1.5 Inherited,
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f7a938fd-093a-4a71-b065-51b183654806"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 358, 8, 109, "Input",ExpressionUUID->"ee69c2b9-9a5d-4159-b2a0-5b5df8704827"],
Cell[941, 32, 1012, 18, 242, "Message",ExpressionUUID->"c37eb675-49f0-4351-9175-4ac0c38079a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1990, 55, 17175, 460, 2905, "Input",ExpressionUUID->"55e6e0fb-26da-4949-814b-41d95cdac340"],
Cell[19168, 517, 181, 4, 36, "Print",ExpressionUUID->"934f4a0f-8201-48c5-bb79-8b732a6b8ccd"]
}, Open  ]],
Cell[19364, 524, 5688, 161, 729, "Input",ExpressionUUID->"0b4d135e-e348-4875-86e4-355fe52690f2"],
Cell[CellGroupData[{
Cell[25077, 689, 5814, 173, 1225, "Input",ExpressionUUID->"eb1c114d-a4dc-423a-a184-ddc84d5b6b4f"],
Cell[CellGroupData[{
Cell[30916, 866, 410, 10, 36, "Print",ExpressionUUID->"0127df2f-fcd3-4879-9e57-4c77880561c1"],
Cell[31329, 878, 456, 11, 36, "Print",ExpressionUUID->"b7b6b806-a766-4db8-864d-e55f38ffa7f7"],
Cell[31788, 891, 2361, 47, 95, "Print",ExpressionUUID->"7f93001d-1509-487c-ae6a-34e20de75979"],
Cell[34152, 940, 5745, 145, 182, "Print",ExpressionUUID->"a27d4ca0-55cb-488e-af2a-afba2c3a4473"]
}, Open  ]]
}, Open  ]],
Cell[39924, 1089, 14220, 317, 2992, "Input",ExpressionUUID->"46f15645-9604-4777-82fe-7414dc24774c"]
}
]
*)

(* End of internal cache information *)

